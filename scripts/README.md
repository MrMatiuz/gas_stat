# Скрипт импорта данных из Excel

Этот скрипт позволяет импортировать данные о заправках из Excel файла в Firebase Firestore.

## Подготовка

1. Убедитесь, что файл `.env` настроен с правильными значениями Firebase
2. Excel файл должен быть в формате `.xlsx` или `.xls`

## Формат Excel файла

Файл должен содержать следующие колонки (названия могут быть на русском или английском):

| Колонка | Варианты названий |
|---------|------------------|
| Дата | `Дата`, `date`, `Date`, `ДАТА`, `Дата заправки` |
| Машина | `Машина`, `car`, `Car`, `МАШИНА`, `Автомобиль`, `Название машины`, `carName` |
| Пробег | `Пробег`, `mileage`, `Mileage`, `ПРОБЕГ`, `Пробег (км)`, `km` |
| Литры | `Литры`, `liters`, `Liters`, `ЛИТРЫ`, `Количество литров`, `L` |
| Цена за литр | `Цена за литр`, `pricePerLiter`, `Price`, `Цена`, `цена` |
| Общая сумма | `Общая сумма`, `totalPrice`, `Total`, `Сумма`, `сумма` |

**Важно:** 
- Обязательны: Дата, Машина, Литры
- Нужна либо "Цена за литр", либо "Общая сумма" (или обе)
- Если указана только одна из цен, вторая будет вычислена автоматически

## Использование

### Вариант 1: Через npm script

```bash
npm run import-excel <путь_к_файлу> <email> <password>
```

Пример:
```bash
npm run import-excel ./data.xlsx user@example.com mypassword
```

### Вариант 2: Напрямую через node

```bash
node scripts/import-excel.js <путь_к_файлу> <email> <password>
```

## Пример Excel файла

| Дата | Машина | Пробег | Литры | Цена за литр | Общая сумма |
|------|--------|--------|-------|--------------|-------------|
| 2024-01-15 | Toyota Camry | 50000 | 40.5 | 45.50 | 1842.75 |
| 2024-01-20 | BMW X5 | 75000 | 60.0 | 48.00 | 2880.00 |

## Что делает скрипт

1. Входит в Firebase с указанными учетными данными
2. Читает Excel файл
3. Для каждой строки:
   - Парсит данные
   - Проверяет валидность
   - Создает машину, если её еще нет
   - Добавляет запись о заправке в Firestore
4. Показывает статистику импорта

## Примечания

- Скрипт автоматически создает машины, если их еще нет
- Даты в Excel автоматически конвертируются в формат YYYY-MM-DD
- Пропускаются строки с некорректными данными (с предупреждением)
- Все данные привязываются к указанному пользователю
